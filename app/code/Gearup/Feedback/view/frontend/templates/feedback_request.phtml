<style>
    .star-rating {
        white-space: nowrap;
        display: inline-block;
        width: 235px;
        height: 45px;
        position: relative;
        background: url('/media/wysiwyg/star_12.png');
        background-size: contain;
    }

    .star-rating i {
        opacity: 0;
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 20%;
        z-index: 1;
        background: url('/media/wysiwyg/star_11.png');
        background-size: contain;
    }

    .star-rating input {
        -moz-appearance: none;
        -webkit-appearance: none;
        opacity: 0;
        display: inline-block;
        width: 20%;
        height: 100%;
        margin: 0;
        padding: 0;
        z-index: 2;
        position: relative;
    }

    .star-rating input:hover+i,
    .star-rating input:checked+i {
        opacity: 1;
    }

    .star-rating i~i {
        width: 40%;
    }

    .star-rating i~i~i {
        width: 60%;
    }

    .star-rating i~i~i~i {
        width: 80%;
    }

    .star-rating i~i~i~i~i {
        width: 100%;
    }
</style>

<?php
$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
$context = $objectManager->get('Magento\Framework\App\Http\Context');
$isLoggedIn = $context->getValue(\Magento\Customer\Model\Context::CONTEXT_AUTH);
$customerEmail = "";
if ($isLoggedIn) {
    $loginCheck = 1;
    $customerSession = $objectManager->create('Magento\Customer\Model\Session');
    $customerEmail = $customerSession->getCustomer()->getEmail();
} else {
    $loginCheck = 0;
}
$mediaPath = $objectManager->get('Magento\Store\Model\StoreManagerInterface')
    ->getStore()
    ->getBaseUrl(\Magento\Framework\UrlInterface::URL_TYPE_MEDIA);
?>

<div id="review-popup-modal" class="review-popup" style="display:none;">
    <h2>Give feedback</h2>
    <p class="pop-simple-text"> How are we doing? Please rate your experience </p>
    <form method="post" class="review-form" id="review-request-form" action="javascript:void(0)">
        <input type="hidden" name="email" value="<?php echo $customerEmail; ?>">
        <!-- <span class="star-rating">
            <input type="radio" name="rating" value="1"><i></i>
            <input type="radio" name="rating" value="2"><i></i>
            <input type="radio" name="rating" value="3"><i></i>
            <input type="radio" name="rating" value="4"><i></i>
            <input type="radio" name="rating" value="5"><i></i>
        </span> -->

        <div class="smiley-cnt">
            <div class="item" id="smiley-1">
              <label for="0">
              <input class="radio" type="radio" name="rating"  value="1">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="84" height="84" viewBox="0 0 84 84" fill="none">
                    <path d="M21.4996 82.3917C31.0754 82.3917 38.838 81.4602 38.838 80.3111C38.838 79.162 31.0754 78.2305 21.4996 78.2305C11.9239 78.2305 4.16125 79.162 4.16125 80.3111C4.16125 81.4602 11.9239 82.3917 21.4996 82.3917Z" fill="#65B1EF"/>
                    <path d="M58.2569 83.2239C72.046 83.2239 83.2242 82.1061 83.2242 80.7272C83.2242 79.3483 72.046 78.2305 58.2569 78.2305C44.4679 78.2305 33.2897 79.3483 33.2897 80.7272C33.2897 82.1061 44.4679 83.2239 58.2569 83.2239Z" fill="#65B1EF"/>
                    <path d="M41.6121 83.2242C64.5938 83.2242 83.2242 64.5938 83.2242 41.6121C83.2242 18.6304 64.5938 0 41.6121 0C18.6304 0 0 18.6304 0 41.6121C0 64.5938 18.6304 83.2242 41.6121 83.2242Z" fill="#FFDD67"/>
                    <path d="M59.2279 61.0309C57.286 56.0375 52.57 52.7085 41.6121 52.7085C30.5156 52.7085 25.9382 56.0375 23.9963 61.0309C23.0254 63.6664 24.4124 67.9663 24.4124 67.9663C26.2156 73.3758 25.9382 74.9016 41.6121 74.9016C57.286 74.9016 57.0086 73.3758 58.8118 67.9663C58.8118 67.9663 60.3376 63.6664 59.2279 61.0309Z" fill="#664E27"/>
                    <path d="M54.0957 59.6441C54.2344 59.228 54.0957 58.8119 53.8183 58.5345C53.8183 58.5345 51.0441 55.4829 41.6121 55.4829C32.18 55.4829 29.4058 58.5345 29.4058 58.5345C29.1284 58.6732 29.1284 59.228 29.1284 59.6441L29.4058 60.4764C29.5445 60.8925 29.822 61.1699 30.0994 61.1699H53.1247C53.4021 61.1699 53.8183 60.8925 53.8183 60.4764L54.0957 59.6441Z" fill="white"/>
                    <path d="M58.9505 81.1438H68.3826C79.7566 67.4118 66.302 53.4024 69.631 39.8091C66.4407 39.8091 63.2504 43.2768 60.1989 43.2768C55.7602 56.4539 70.3245 67.4118 58.9505 81.1438ZM24.2737 81.1438H14.8417C3.46769 67.4118 16.9223 53.4024 13.5933 39.8091C16.7836 39.8091 19.9738 43.2768 23.0254 43.2768C27.464 56.4539 12.8998 67.4118 24.2737 81.1438Z" fill="#65B1EF"/>
                    <path d="M53.6796 22.6091C57.8408 26.7703 63.6665 28.8509 69.4922 28.2961C70.3245 28.1574 70.7406 31.209 69.7696 31.3477C62.973 31.9025 56.315 29.5445 51.599 24.6897C50.7668 23.9962 53.1248 22.0543 53.6796 22.6091ZM13.8707 28.2961C19.6964 28.8509 25.5221 26.7703 29.6833 22.6091C30.2381 22.0543 32.5961 23.9962 31.9026 24.6897C27.1866 29.5445 20.3899 31.9025 13.732 31.3477C12.4836 31.3477 13.0384 28.2961 13.8707 28.2961Z" fill="#917524"/>
                    <path d="M47.0216 39.2538C52.8473 50.3503 64.6374 50.3503 70.4631 39.2538C70.7405 38.6989 70.047 38.4215 69.076 37.8667C63.2503 42.444 53.6796 42.0279 48.4087 37.8667C47.5765 38.4215 46.7442 38.6989 47.0216 39.2538ZM12.761 39.2538C18.5867 50.3503 30.3768 50.3503 36.2025 39.2538C36.4799 38.6989 35.7864 38.4215 34.8154 37.8667C28.9897 42.444 19.4189 42.0279 14.1481 37.8667C13.1771 38.4215 12.4836 38.6989 12.761 39.2538Z" fill="#664E27"/>
                </svg>
              </span>
            </label>
            </div>

            <div class="item" id="smiley-2">
              <label for="1">
              <input class="radio" type="radio" name="rating"  value="2">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="84" height="84" viewBox="0 0 84 84" fill="none">
                    <path d="M41.6121 83.2242C64.5938 83.2242 83.2242 64.5938 83.2242 41.6121C83.2242 18.6304 64.5938 0 41.6121 0C18.6304 0 0 18.6304 0 41.6121C0 64.5938 18.6304 83.2242 41.6121 83.2242Z" fill="#FFDD67"/>
                    <path d="M25.6608 42.4444C29.4911 42.4444 32.5962 39.3394 32.5962 35.5091C32.5962 31.6788 29.4911 28.5737 25.6608 28.5737C21.8305 28.5737 18.7255 31.6788 18.7255 35.5091C18.7255 39.3394 21.8305 42.4444 25.6608 42.4444Z" fill="#664E27"/>
                    <path d="M57.5634 42.4444C61.3937 42.4444 64.4988 39.3394 64.4988 35.5091C64.4988 31.6788 61.3937 28.5737 57.5634 28.5737C53.7331 28.5737 50.6281 31.6788 50.6281 35.5091C50.6281 39.3394 53.7331 42.4444 57.5634 42.4444Z" fill="#664E27"/>
                    <path d="M51.1829 63.8051H32.0413C29.9607 63.8051 29.9607 58.2568 32.0413 58.2568H51.0442C53.2635 58.2568 53.2635 63.8051 51.1829 63.8051Z" fill="#664E27"/>
                </svg>
              </span>
            </label>
            </div>

            <div class="item" id="smiley-3">
              <label for="2">
              <input class="radio" type="radio" name="rating"  value="3">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="84" height="84" viewBox="0 0 84 84" fill="none">
                    <path d="M41.6121 83.2242C64.5938 83.2242 83.2242 64.5938 83.2242 41.6121C83.2242 18.6304 64.5938 0 41.6121 0C18.6304 0 0 18.6304 0 41.6121C0 64.5938 18.6304 83.2242 41.6121 83.2242Z" fill="#FFDD67"/>
                    <path d="M25.6608 41.0572C29.4911 41.0572 32.5962 37.9522 32.5962 34.1219C32.5962 30.2916 29.4911 27.1865 25.6608 27.1865C21.8305 27.1865 18.7255 30.2916 18.7255 34.1219C18.7255 37.9522 21.8305 41.0572 25.6608 41.0572Z" fill="#664E27"/>
                    <path d="M57.5634 41.0572C61.3937 41.0572 64.4988 37.9522 64.4988 34.1219C64.4988 30.2916 61.3937 27.1865 57.5634 27.1865C53.7331 27.1865 50.6281 30.2916 50.6281 34.1219C50.6281 37.9522 53.7331 41.0572 57.5634 41.0572Z" fill="#664E27"/>
                    <path d="M59.0892 53.1247C47.8539 61.031 35.3703 60.8923 24.135 53.1247C22.7479 52.1538 21.6383 53.8183 22.4705 55.344C25.9382 60.8923 32.7348 66.0245 41.6121 66.0245C50.4893 66.0245 57.286 61.031 60.7537 55.344C61.5859 53.8183 60.4762 52.1538 59.0892 53.1247Z" fill="#664E27"/>
                </svg>
              </span>
            </label>
            </div>

            <div class="item" id="smiley-4">
              <label for="3">
              <input class="radio" type="radio" name="rating"  value="4">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="84" height="84" viewBox="0 0 84 84" fill="none">
                    <path d="M83.2242 41.6121C83.2242 64.6375 64.6375 83.2242 41.6121 83.2242C18.5867 83.2242 0 64.6375 0 41.6121C0 18.5867 18.5867 0 41.6121 0C64.6375 0 83.2242 18.5867 83.2242 41.6121Z" fill="#FFDD67"/>
                    <path d="M65.1924 49.9348C65.1924 48.8251 64.4988 47.4381 62.6957 47.0219C57.8409 46.051 50.7668 45.2188 41.6122 45.2188C32.4575 45.2188 25.3835 46.1897 20.5287 47.0219C18.7255 47.4381 18.032 48.8251 18.032 49.9348C18.032 60.0604 25.7996 70.186 41.6122 70.186C57.4248 70.186 65.1924 60.0604 65.1924 49.9348Z" fill="#664E27"/>
                    <path d="M36.7573 34.5384C34.1218 27.4643 30.238 23.8579 26.3542 23.8579C22.4704 23.8579 18.5867 27.4643 15.9512 34.5384C15.6738 35.2319 17.0609 36.4802 17.7544 35.7867C20.2511 33.1513 23.3027 32.0416 26.3542 32.0416C29.4058 32.0416 32.4574 33.1513 34.9541 35.7867C35.7863 36.4802 37.0347 35.2319 36.7573 34.5384Z" fill="#664E27"/>
                    <path d="M67.1345 34.5384C64.499 27.4643 60.6152 23.8579 56.7314 23.8579C52.8476 23.8579 48.9638 27.4643 46.3284 34.5384C46.051 35.2319 47.4381 36.4802 48.1316 35.7867C50.6283 33.1513 53.6799 32.0416 56.7314 32.0416C59.9217 32.0416 62.8345 33.1513 65.3313 35.7867C66.0248 36.4802 67.4119 35.2319 67.1345 34.5384Z" fill="#664E27"/>
                    <path d="M59.2278 50.3504C56.1762 49.7956 49.7957 48.9634 41.612 48.9634C33.4282 48.9634 27.0477 49.7956 23.9962 50.3504C22.193 50.6279 22.0543 51.3214 22.193 52.4311C22.3317 52.9859 22.3317 53.8181 22.6091 54.6504C22.7478 55.4826 23.0252 55.8987 24.4123 55.76C27.0477 55.4826 56.3149 55.4826 58.9503 55.76C60.3374 55.8987 60.4761 55.4826 60.7535 54.6504C60.8922 53.8181 61.0309 53.1246 61.1697 52.4311C61.1697 51.3214 61.031 50.6279 59.2278 50.3504Z" fill="white"/>
                    <path d="M83.2242 41.6121C83.2242 64.6375 64.6375 83.2242 41.6121 83.2242C18.5867 83.2242 0 64.6375 0 41.6121C0 18.5867 18.5867 0 41.6121 0C64.6375 0 83.2242 18.5867 83.2242 41.6121Z" fill="#FFDD67"/>
                    <path d="M65.1924 49.9348C65.1924 48.8251 64.4988 47.4381 62.6957 47.0219C57.8409 46.051 50.7668 45.2188 41.6122 45.2188C32.4575 45.2188 25.3835 46.1897 20.5287 47.0219C18.7255 47.4381 18.032 48.8251 18.032 49.9348C18.032 60.0604 25.7996 70.186 41.6122 70.186C57.4248 70.186 65.1924 60.0604 65.1924 49.9348Z" fill="#664E27"/>
                    <path d="M36.7573 34.5384C34.1218 27.4643 30.238 23.8579 26.3542 23.8579C22.4704 23.8579 18.5867 27.4643 15.9512 34.5384C15.6738 35.2319 17.0609 36.4802 17.7544 35.7867C20.2511 33.1513 23.3027 32.0416 26.3542 32.0416C29.4058 32.0416 32.4574 33.1513 34.9541 35.7867C35.7863 36.4802 37.0347 35.2319 36.7573 34.5384Z" fill="#664E27"/>
                    <path d="M67.1345 34.5384C64.499 27.4643 60.6152 23.8579 56.7314 23.8579C52.8476 23.8579 48.9638 27.4643 46.3284 34.5384C46.051 35.2319 47.4381 36.4802 48.1316 35.7867C50.6283 33.1513 53.6799 32.0416 56.7314 32.0416C59.9217 32.0416 62.8345 33.1513 65.3313 35.7867C66.0248 36.4802 67.4119 35.2319 67.1345 34.5384Z" fill="#664E27"/>
                    <path d="M59.2278 50.3504C56.1762 49.7956 49.7957 48.9634 41.612 48.9634C33.4282 48.9634 27.0477 49.7956 23.9962 50.3504C22.193 50.6279 22.0543 51.3214 22.193 52.4311C22.3317 52.9859 22.3317 53.8181 22.6091 54.6504C22.7478 55.4826 23.0252 55.76 24.4123 55.76H58.9503C60.3374 55.76 60.4761 55.4826 60.7535 54.6504C60.8922 53.8181 61.0309 53.1246 61.1697 52.4311C61.1697 51.3214 61.031 50.6279 59.2278 50.3504Z" fill="white"/>
                </svg>
              </span>
            </label>
            </div>

            <div class="item" id="smiley-5">
              <label for="4">
              <input class="radio" type="radio" name="rating"  value="5">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="84" height="84" viewBox="0 0 84 84" fill="none">
                    <path d="M83.2241 41.6197C83.2241 64.6209 64.6568 83.1882 41.6556 83.1882C18.6544 83.1882 0.0871582 64.6209 0.0871582 41.6197C0.0871582 18.6185 18.6544 0.0512695 41.6556 0.0512695C64.6568 0.0512695 83.2241 18.6185 83.2241 41.6197Z" fill="#FFDD67"/>
                    <path d="M82.9471 15.57C82.2543 11.8288 80.1759 8.78049 76.7118 7.81056C72.9707 6.84063 69.6452 8.22625 66.4583 11.5517C64.657 6.56351 61.8858 2.82235 57.4518 0.882488C53.0178 -1.05737 48.5838 0.328242 45.8126 3.79228C42.9028 7.39488 41.7943 13.0759 44.8427 20.4197C47.7525 27.3477 60.6387 41.2039 61.0544 41.6196C61.6086 41.3424 76.019 32.336 79.4831 27.902C82.9471 23.6066 83.6399 19.3112 82.9471 15.57ZM37.4989 3.79228C34.7277 0.328242 30.2937 -1.05737 25.8598 0.882488C21.4258 2.82235 18.6546 6.56351 16.8533 11.5517C13.5278 8.36481 10.2023 6.84063 6.46115 7.94913C3.13567 8.91906 0.918688 11.9674 0.22588 15.7086C-0.466928 19.3112 0.364442 23.7451 3.68992 28.0405C7.29252 32.336 21.7029 41.3424 22.2572 41.6196C22.6728 41.2039 35.5591 27.3477 38.4689 20.4197C41.5172 13.0759 40.4087 7.53344 37.4989 3.79228Z" fill="#F46767"/>
                    <path d="M65.2113 50.0719C65.2113 48.9634 64.5185 47.5778 62.7172 47.1621C57.8675 46.1922 50.8009 45.3608 41.6558 45.3608C32.5107 45.3608 25.4441 46.3308 20.5944 47.1621C18.6546 47.5778 18.1003 48.9634 18.1003 50.0719C18.1003 60.1869 25.8598 70.3019 41.6558 70.3019C57.4518 70.1634 65.2113 60.0484 65.2113 50.0719Z" fill="#664E27"/>
                    <path d="M59.2531 50.349C56.2047 49.7947 49.8309 48.9634 41.6558 48.9634C33.4806 48.9634 27.1068 49.7947 24.0584 50.349C22.2571 50.6261 22.1186 51.3189 22.2571 52.4274C22.3957 52.9817 22.3957 53.813 22.6728 54.6444C22.8114 55.4758 23.0885 55.8915 24.4741 55.7529C27.1068 55.4758 56.3433 55.4758 58.9759 55.7529C60.3616 55.8915 60.5001 55.4758 60.7772 54.6444C60.9158 53.813 61.0544 53.1202 61.1929 52.4274C61.1929 51.3189 61.0544 50.6261 59.2531 50.349Z" fill="white"/>
                </svg>
              </span>
            </label>
            </div>
        </div>
        <button type="submit" class="submit-btn">Submit</button>
    </form>
</div>  

<div id="review-success-modal" class="review-popup" style="display:none;">
    <div class="rating-review">
        <span id="rating-result"></span>
    </div>
    <div class="rating-success-review">
        <h2>Thank you for your valuable feedback.</h2>
    </div>
</div>

<div id="review-login-modal" class="review-login-popup" style="display:none;">
    <div class="rating-success-review">
        <h2> Please Login </h2>
        <p>You need to <a href="<?php echo $this->getUrl('customer/account/login'); ?>">login</a> first to give
            feedback.</p>
    </div>
</div>

<script>
    require(
        [
            'jquery',
            'Magento_Ui/js/modal/modal'
        ],
        function (
            $, modal
        ) {
            var options = {
                type: 'popup',
                responsive: true,
                innerScroll: true,
                buttons: [{
                    click: function () {
                        this.closeModal();
                    }
                }]
            };
            var options4 = {
                type: 'popup',
                responsive: true,
                innerScroll: true,
                buttons: [{
                    click: function () {
                        this.closeModal();
                    }
                }]
            };
            var options5 = {
                type: 'popup',
                responsive: true,
                innerScroll: true,
                buttons: [{
                    click: function () {
                        this.closeModal();
                    }
                }]
            };

            var popup = modal(options, $('#review-popup-modal'));
            var popup4 = modal(options4, $('#review-success-modal'));
            var popup5 = modal(options5, $('#review-login-modal'));
            var loginCheck = '<?php echo $loginCheck; ?>';

            $(".review-feedback").on('click', function () {
                if (loginCheck == true) {
                    $("#review-popup-modal").modal("openModal");
                } else {
                    $("#review-login-modal").modal("openModal");
                }
            });

            $('#review-request-form').on('submit', function (e) {
                var form = $("#review-request-form");
                url = "<?php echo $this->getUrl('feedback/index/postdata'); ?>";

                jQuery.ajax({
                    url: url,
                    type: 'Post',
                    dataType: 'json',
                    showLoader: true,
                    data: form.serialize()
                }).done(function (result) {
                    var smiley = "";

                    if (result.html == "1.0"){
                       smiley = $("#smiley-1 span").html(); 
                    }else if (result.html == "2.0"){
                        smiley = $("#smiley-2 span").html();
                    }else if (result.html == "3.0"){
                        smiley = $("#smiley-3 span").html();
                    }else if (result.html == "4.0"){
                        smiley = $("#smiley-4 span").html();
                    }else if (result.html == "5.0"){
                        smiley = $("#smiley-5 span").html();
                    } 

                    $("#review-request-form")[0].reset();
                    $("#review-popup-modal").modal("closeModal");
                    $("#review-success-modal #rating-result").html(smiley);
                    $("#review-success-modal").modal("openModal");
                });

            });

            /*$('#review-request-form input:radio').change(function() {
                alert(this.value);
            });*/
        }
    );
</script>